(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2695:function(e,t,r){Promise.resolve().then(r.bind(r,1331))},1331:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return m}});var a=r(7437),n=r(2265),s=r(7826),i=r(4305);let l=()=>{let e=(0,n.useRef)(null),{currentTrack:t,isPlaying:r,isPaused:a,currentTime:l,duration:c,volume:d,playbackRate:o,repeatMode:u,shuffleMode:m,queue:p,currentIndex:x,setCurrentTrack:h,togglePlayPause:f,play:g,pause:v,stop:b,seek:j,setVolume:w,setPlaybackRate:N,setRepeatMode:y,setShuffleMode:k,nextTrack:E,previousTrack:C,setQueue:L,setCurrentIndex:S,updateTrack:A}=(0,s.U)();(0,n.useEffect)(()=>{e.current||(e.current=(0,i.DG)(""));let t=e.current,r=()=>{D(t.duration)},a=()=>{T(t.currentTime)},n=()=>{F()},s=()=>{console.error("Audio playback error"),v()},l=()=>{};return t.addEventListener("loadedmetadata",r),t.addEventListener("timeupdate",a),t.addEventListener("ended",n),t.addEventListener("error",s),t.addEventListener("canplay",l),()=>{t.removeEventListener("loadedmetadata",r),t.removeEventListener("timeupdate",a),t.removeEventListener("ended",n),t.removeEventListener("error",s),t.removeEventListener("canplay",l)}},[]),(0,n.useEffect)(()=>{t&&e.current&&(e.current.src=t.url,e.current.load(),A(t.id,{playCount:(t.playCount||0)+1}))},[t,A]),(0,n.useEffect)(()=>{e.current&&(r?e.current.play().catch(console.error):e.current.pause())},[r]),(0,n.useEffect)(()=>{e.current&&(e.current.volume=(0,i.FL)(d))},[d]),(0,n.useEffect)(()=>{e.current&&(e.current.playbackRate=(0,i.ef)(o))},[o]);let T=(0,n.useCallback)(t=>{e.current&&(e.current.currentTime=t)},[]),D=(0,n.useCallback)(e=>{},[]),F=(0,n.useCallback)(()=>{"one"===u?e.current&&(e.current.currentTime=0,e.current.play().catch(console.error)):E()},[u,E]),H=(0,n.useCallback)(e=>{h(e),g()},[h,g]),M=(0,n.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;L(e),S(t),h(e[t]),g()},[L,S,h,g]),z=(0,n.useCallback)(e=>{T(e),j(e)},[T,j]),_=(0,n.useCallback)(e=>{w((0,i.FL)(e))},[w]),I=(0,n.useCallback)(e=>{N((0,i.ef)(e))},[N]),O=(0,n.useCallback)(e=>{y(e)},[y]),P=(0,n.useCallback)(e=>{k(e)},[k]),U=(0,n.useCallback)(()=>{E()},[E]),R=(0,n.useCallback)(()=>{C()},[C]),W=(0,n.useCallback)(()=>{f()},[f]),Y=(0,n.useCallback)(()=>{b(),e.current&&(e.current.pause(),e.current.currentTime=0)},[b]);return(0,n.useEffect)(()=>{t&&"mediaSession"in navigator&&(navigator.mediaSession.metadata=new MediaMetadata({title:t.title,artist:t.artist,album:t.metadata.album||"",artwork:t.thumbnail?[{src:t.thumbnail,sizes:"96x96",type:"image/png"},{src:t.thumbnail,sizes:"128x128",type:"image/png"},{src:t.thumbnail,sizes:"192x192",type:"image/png"},{src:t.thumbnail,sizes:"256x256",type:"image/png"},{src:t.thumbnail,sizes:"384x384",type:"image/png"},{src:t.thumbnail,sizes:"512x512",type:"image/png"}]:[]}),navigator.mediaSession.setActionHandler("play",()=>{g()}),navigator.mediaSession.setActionHandler("pause",()=>{v()}),navigator.mediaSession.setActionHandler("stop",()=>{Y()}),navigator.mediaSession.setActionHandler("previoustrack",()=>{R()}),navigator.mediaSession.setActionHandler("nexttrack",()=>{U()}),navigator.mediaSession.setActionHandler("seekbackward",e=>{z(Math.max(0,l-(e.seekOffset||10)))}),navigator.mediaSession.setActionHandler("seekforward",e=>{z(Math.min(c,l+(e.seekOffset||10)))}),navigator.mediaSession.setActionHandler("seekto",e=>{void 0!==e.seekTime&&z(e.seekTime)}),navigator.mediaSession.playbackState=r?"playing":"paused")},[t,r,l,c,g,v,Y,R,U,z]),{currentTrack:t,isPlaying:r,isPaused:a,currentTime:l,duration:c,volume:d,playbackRate:o,repeatMode:u,shuffleMode:m,queue:p,currentIndex:x,playTrack:H,playPlaylist:M,handlePlayPause:W,handleStop:Y,handleSeek:z,handleVolumeChange:_,handlePlaybackRateChange:I,handleRepeatModeChange:O,handleShuffleModeChange:P,handleNext:U,handlePrevious:R}},c=()=>{let[e,t]=(0,n.useState)(!1),[r,a]=(0,n.useState)(!1),[s,i]=(0,n.useState)(null),[l,c]=(0,n.useState)(navigator.onLine),[d,o]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{let e=()=>{let e=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://");o(e),a(e)};e();let t=window.matchMedia("(display-mode: standalone)"),r=()=>e();return t.addEventListener("change",r),()=>{t.removeEventListener("change",r)}},[]),(0,n.useEffect)(()=>{let e=()=>c(!0),t=()=>c(!1);return window.addEventListener("online",e),window.addEventListener("offline",t),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}},[]),(0,n.useEffect)(()=>{let e=e=>{e.preventDefault(),i(e),t(!0)};return window.addEventListener("beforeinstallprompt",e),()=>{window.removeEventListener("beforeinstallprompt",e)}},[]),(0,n.useEffect)(()=>{let e=()=>{a(!0),t(!1),i(null)};return window.addEventListener("appinstalled",e),()=>{window.removeEventListener("appinstalled",e)}},[]),{isInstallable:e,isInstalled:r,isOnline:l,isStandalone:d,canInstall:e&&!r,install:(0,n.useCallback)(async()=>{if(!s)return!1;try{await s.prompt();let{outcome:e}=await s.userChoice;if("accepted"===e)return a(!0),t(!1),i(null),!0;return!1}catch(e){return console.error("Failed to install PWA:",e),!1}},[s])}};var d=r(2169);let o=e=>{let{children:t,fallback:r=null}=e,[s,i]=(0,n.useState)(!1);return((0,n.useEffect)(()=>{i(!0)},[]),s)?(0,a.jsx)(a.Fragment,{children:t}):(0,a.jsx)(a.Fragment,{children:r})};function u(){let{tracks:e,getFilteredTracks:t}=(0,s.U)(),{currentTrack:r,isPlaying:i,currentTime:o,duration:u,volume:m,handlePlayPause:p,handleSeek:x,handleVolumeChange:h,playTrack:f}=l(),{canInstall:g,install:v}=c(),[b,j]=(0,n.useState)(!1),w=t();(0,n.useEffect)(()=>{if(g){let e=setTimeout(()=>{j(!0)},3e3);return()=>clearTimeout(e)}},[g]);let N=async()=>{await v()&&j(!1)},y=e=>{f(e)};return(0,a.jsxs)("div",{className:"min-h-screen bg-background text-foreground",children:[b&&g&&(0,a.jsx)("div",{className:"fixed top-4 left-4 right-4 z-50 bg-primary text-primary-foreground p-4 rounded-lg shadow-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold",children:"Install Music App"}),(0,a.jsx)("p",{className:"text-sm opacity-90",children:"Install this app for a better experience"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>j(!1),className:"px-3 py-1 text-sm bg-white/20 rounded hover:bg-white/30",children:"Later"}),(0,a.jsx)("button",{onClick:N,className:"px-3 py-1 text-sm bg-white text-primary rounded hover:bg-white/90",children:"Install"})]})]})}),(0,a.jsx)("header",{className:"bg-card border-b border-border p-4",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Music App PWA"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Your offline music collection"})]})}),(0,a.jsxs)("div",{className:"max-w-6xl mx-auto p-4",children:[r&&(0,a.jsx)("div",{className:"bg-card border border-border rounded-lg p-4 mb-6",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h3",{className:"font-semibold truncate",children:r.title}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground truncate",children:r.artist})]}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)("button",{onClick:p,className:"w-10 h-10 bg-primary text-primary-foreground rounded-full flex items-center justify-center hover:bg-primary/90",children:i?"⏸️":"▶️"})}),(0,a.jsx)("div",{className:"flex-1 min-w-0",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,a.jsx)("span",{children:(0,d.mr)(o)}),(0,a.jsx)("input",{type:"range",min:"0",max:"100",value:u>0?o/u*100:0,onChange:e=>{x(parseFloat(e.target.value)/100*u)},className:"flex-1 h-1 bg-muted rounded-lg appearance-none cursor-pointer"}),(0,a.jsx)("span",{children:(0,d.mr)(u)})]})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"\uD83D\uDD0A"}),(0,a.jsx)("input",{type:"range",min:"0",max:"100",value:100*m,onChange:e=>{h(parseFloat(e.target.value)/100)},className:"w-20 h-1 bg-muted rounded-lg appearance-none cursor-pointer"})]})]})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("h2",{className:"text-lg font-semibold mb-4",children:["All Tracks (",w.length,")"]}),0===w.length?(0,a.jsxs)("div",{className:"text-center py-12 text-muted-foreground",children:[(0,a.jsx)("p",{className:"text-lg mb-2",children:"No tracks found"}),(0,a.jsx)("p",{className:"text-sm",children:"Use the dispatch page to download audio files from YouTube"})]}):(0,a.jsx)("div",{className:"space-y-1",children:w.map(e=>(0,a.jsx)("div",{onClick:()=>y(e),className:"p-3 rounded-lg border cursor-pointer transition-colors hover:bg-muted/50 ".concat((null==r?void 0:r.id)===e.id?"bg-primary/10 border-primary":"bg-card border-border"),children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-muted rounded flex items-center justify-center",children:e.thumbnail?(0,a.jsx)("img",{src:e.thumbnail,alt:e.title,className:"w-full h-full rounded object-cover"}):(0,a.jsx)("span",{className:"text-lg",children:"\uD83C\uDFB5"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h3",{className:"font-medium truncate",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground truncate",children:e.artist})]}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:(0,d.mr)(e.duration)})]})},e.id))})]}),(0,a.jsx)("div",{className:"fixed bottom-4 right-4 flex gap-2",children:(0,a.jsx)("a",{href:"/dispatch",className:"px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors",children:"Download Audio"})})]})]})}function m(){return(0,a.jsx)(o,{fallback:(0,a.jsx)("div",{className:"min-h-screen bg-background text-foreground flex items-center justify-center",children:"Loading..."}),children:(0,a.jsx)(u,{})})}}},function(e){e.O(0,[175,506,971,938,744],function(){return e(e.s=2695)}),_N_E=e.O()}]);